import{A as O,V as _,Q as W,a as A,M as y,b as k,c as T,S as q,u as j,R as B,d as D,j as p}from"./index-BOv0iVsN.js";function g(i,a,e={}){const t=new k,o=new T,l=new k,b=new y,c=new y,u=new y;e.preserveMatrix=e.preserveMatrix!==void 0?e.preserveMatrix:!0,e.preservePosition=e.preservePosition!==void 0?e.preservePosition:!0,e.preserveHipPosition=e.preserveHipPosition!==void 0?e.preserveHipPosition:!1,e.useTargetMatrix=e.useTargetMatrix!==void 0?e.useTargetMatrix:!1,e.hip=e.hip!==void 0?e.hip:"hip",e.names=e.names||{};const h=a.isObject3D?a.skeleton.bones:v(a),d=i.isObject3D?i.skeleton.bones:v(i);let f,r,n,M,m;if(i.isObject3D?i.skeleton.pose():(e.useTargetMatrix=!0,e.preserveMatrix=!1),e.preservePosition){m=[];for(let s=0;s<d.length;s++)m.push(d[s].position.clone())}if(e.preserveMatrix){i.updateMatrixWorld(),i.matrixWorld.identity();for(let s=0;s<i.children.length;++s)i.children[s].updateMatrixWorld(!0)}if(e.offsets){f=[];for(let s=0;s<d.length;++s)r=d[s],n=e.names[r.name]||r.name,e.offsets[n]&&(r.matrix.multiply(e.offsets[n]),r.matrix.decompose(r.position,r.quaternion,r.scale),r.updateMatrixWorld()),f.push(r.matrixWorld.clone())}for(let s=0;s<d.length;++s){if(r=d[s],n=e.names[r.name]||r.name,M=w(n,h),u.copy(r.matrixWorld),M){if(M.updateMatrixWorld(),e.useTargetMatrix?c.copy(M.matrixWorld):(c.copy(i.matrixWorld).invert(),c.multiply(M.matrixWorld)),l.setFromMatrixScale(c),c.scale(l.set(1/l.x,1/l.y,1/l.z)),u.makeRotationFromQuaternion(o.setFromRotationMatrix(c)),i.isObject3D){const x=d.indexOf(r),F=f?f[x]:b.copy(i.skeleton.boneInverses[x]).invert();u.multiply(F)}u.copyPosition(c)}r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(u)):r.matrix.copy(u),e.preserveHipPosition&&n===e.hip&&r.matrix.setPosition(t.set(0,r.position.y,0)),r.matrix.decompose(r.position,r.quaternion,r.scale),r.updateMatrixWorld()}if(e.preservePosition)for(let s=0;s<d.length;++s)r=d[s],n=e.names[r.name]||r.name,n!==e.hip&&r.position.copy(m[s]);e.preserveMatrix&&i.updateMatrixWorld(!0)}function H(i,a,e,t={}){t.useFirstFramePosition=t.useFirstFramePosition!==void 0?t.useFirstFramePosition:!1,t.fps=t.fps!==void 0?t.fps:30,t.names=t.names||[],a.isObject3D||(a=I(a));const o=Math.round(e.duration*(t.fps/1e3)*1e3),l=1/t.fps,b=[],c=new O(a),u=v(i.skeleton),h=[];let d,f,r,n,M;c.clipAction(e).play(),c.update(0),a.updateMatrixWorld();for(let m=0;m<o;++m){const s=m*l;g(i,a,t);for(let x=0;x<u.length;++x)M=t.names[u[x].name]||u[x].name,r=w(M,a.skeleton),r&&(f=u[x],n=h[x]=h[x]||{bone:f},t.hip===M&&(n.pos||(n.pos={times:new Float32Array(o),values:new Float32Array(o*3)}),t.useFirstFramePosition&&(m===0&&(d=f.position.clone()),f.position.sub(d)),n.pos.times[m]=s,f.position.toArray(n.pos.values,m*3)),n.quat||(n.quat={times:new Float32Array(o),values:new Float32Array(o*4)}),n.quat.times[m]=s,f.quaternion.toArray(n.quat.values,m*4));c.update(l),a.updateMatrixWorld()}for(let m=0;m<h.length;++m)n=h[m],n&&(n.pos&&b.push(new _(".bones["+n.bone.name+"].position",n.pos.times,n.pos.values)),b.push(new W(".bones["+n.bone.name+"].quaternion",n.quat.times,n.quat.values)));return c.uncacheAction(e),new A(e.name,-1,b)}function S(i){const a=new Map,e=new Map,t=i.clone();return P(i,t,function(o,l){a.set(l,o),e.set(o,l)}),t.traverse(function(o){if(!o.isSkinnedMesh)return;const l=o,b=a.get(o),c=b.skeleton.bones;l.skeleton=b.skeleton.clone(),l.bindMatrix.copy(b.bindMatrix),l.skeleton.bones=c.map(function(u){return e.get(u)}),l.bind(l.skeleton,l.bindMatrix)}),t}function w(i,a){for(let e=0,t=v(a);e<t.length;e++)if(i===t[e].name)return t[e]}function v(i){return Array.isArray(i)?i:i.bones}function I(i){const a=new q(i.bones[0]);return a.skeleton=i,a}function P(i,a,e){e(i,a);for(let t=0;t<i.children.length;t++)P(i.children[t],a.children[t],e)}const R={retarget:g,retargetClip:H,clone:S};function L(i){const{scene:a}=j("/Portfolio/models/fox_in_a_cape.glb","https://www.gstatic.com/draco/v1/decoders/"),e=B.useMemo(()=>R.clone(a),[a]),{nodes:t,materials:o}=D(e);return p.jsx("group",{...i,dispose:null,children:p.jsx("group",{rotation:[-Math.PI/2,0,0],scale:2.5,children:p.jsx("group",{rotation:[Math.PI/2,0,0],scale:.01,children:p.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:100,children:[p.jsx("primitive",{object:t._rootJoint}),p.jsx("skinnedMesh",{geometry:t.Object_7.geometry,material:o.material,skeleton:t.Object_7.skeleton}),p.jsx("skinnedMesh",{geometry:t.Object_9.geometry,material:o.material,skeleton:t.Object_9.skeleton}),p.jsx("skinnedMesh",{geometry:t.Object_11.geometry,material:o.material,skeleton:t.Object_11.skeleton}),p.jsx("skinnedMesh",{geometry:t.Object_13.geometry,material:o.material,skeleton:t.Object_13.skeleton}),p.jsx("skinnedMesh",{geometry:t.Object_48.geometry,material:o.material,skeleton:t.Object_48.skeleton})]})})})})}j.preload("/Portfolio/models/fox_in_a_cape.glb","https://www.gstatic.com/draco/v1/decoders/");export{L as Fox};
